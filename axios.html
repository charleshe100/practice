<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>axios</title>
    <link rel="shortcut icon" href="#" type="image/x-icon">
    <link rel="stylesheet" href="./css/bootstrap.css">
    <link rel="stylesheet" href="style.css">
    <!-----引入axios函式庫------->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1 class="header">axios</h1>
    <h4 class="title"></h4>
    <div class="updated" ></div>
    <ul class="list-group"></ul>
    <script src="./js/bootstrap.js"></script>
    <!-- <script src="./js/jquery.js"></script>       -->
</body>
</html>
<script>
/********************************************************
* 1.api網址  https://kktix.com/events.json
* 2.發起一個axios請求
* 3.建立回呼函式(call back function)來處理回應時的各項行為
* 4.建立錯誤處理
* 5.證交所API https://openapi.twse.com.tw/v1/exchangeReport/FMSRFK_ALL
********************************************************/

//發起一個axios請求，API：kktix
// axios.get('https://kktix.com/events.json')
    // .then((res)=>{
        // console.log(res.data)
        // let data=res.data
        // let events=data.entry;
        //console.log(events);

        //jquery（jquery與JS原生寫法，二擇一使用）
        // events.forEach((event,idx)=>{
                // $("ul").append(`<li class='list-group-item list-group-item-action'>
                                    // <div>${event.title}</div>
                                // <div>${event.summary}</div>
                                // <div>${event.content}</div>
                            // </li>`)})
            // $(".title").text(data.title)
            // $(".updated").text(data.updated)        

        // JS原生寫法，此方法是虛擬DOM，全部用程式的方式去宣告，不是兜字串，
        // 產生一個物件放在記憶體裡面，以下這些指令都是在記憶體裡面執行
        // 比起字串產生完後，再丟到網頁去，再讓browser慢慢畫出來，效率是快非常多
        // let ul=document.querySelector("ul");        // 選取文檔中第一個 <ul> 元素，並將其賦值給變量 ul
        // events.forEach((event,idx)=>{               // 遍歷 events 數組中的每個元素，並執行箭頭函數中的代碼
            // let li=document.createElement("li");    // 創建一個新的 <li> 元素
                // li.setAttribute('class','list-group-item list-group-item-action');  // 設置 <li> 元素的 class 屬性
            // let div1=document.createElement("div");   // 創建一個新的 <div> 元素，並將其賦值給變量 div1
            // let div2=document.createElement("div");   // 創建一個新的 <div> 元素，並將其賦值給變量 div2
            // let div3=document.createElement("div");   // 創建一個新的 <div> 元素，並將其賦值給變量 div3
            // let title=document.createTextNode(event.title)       // 創建一個包含事件標題文本的文本節點
            // let summary=document.createTextNode(event.summary)   // 創建一個包含事件摘要文本的文本節點
            // let content=document.createTextNode(event.content)   // 創建一個包含事件內容文本的文本節點
            // div1.appendChild(title)     // 將 title 文本節點添加到 div1 中
            // div2.appendChild(summary)   // 將 summary 文本節點添加到 div2 中
            // div3.appendChild(content)   // 將 content 文本節點添加到 div3 中
            // li.appendChild(div1)   // 將 div1 添加到 <li> 元素中
            // li.appendChild(div2)   // 將 div2 添加到 <li> 元素中
            // li.appendChild(div3)   // 將 div3 添加到 <li> 元素中
            // ul.appendChild(li)     // 將 <li> 元素添加到 <ul> 元素中
        // }
        // )
        // document.querySelector(".title").innerHTML=data.title     
        // 選取文檔中第一個 class 為 "title" 的元素，並將其內部的 HTML 設置為 data.title
        // document.querySelector(".title").innerHTML=data.updated
        // 選取文檔中第一個 class 為 "title" 的元素，並將其內部的 HTML 設置為 data.updated
        // 注意：這行代碼會覆蓋前一行設置的 data.title，因為是針對相同的元素
    // })


//發起一個axios請求，API：證交所
axios.get('stock.php')
    .then((res)=>{
        console.log(res.data)
        let data=res.data
        let li='';
        for(let i=0;i<100;i++){
            let ul=document.getElementsByTagName('ul')[0]
            //console.log(ul.innerHTML)
            li=`<li class="list-group-item list-group-item-action">
                    <div>股號:${data[i].Code}</div>
                    <div>公司名:${data[i].Name}</div>
                    <div>收盤價:${data[i].WeightedAvgPriceAB}</div>
                    <div>最高價:${data[i].HighestPrice}</div>
                    <div>最低價:${data[i].LowestPrice}</div>
                </li>`;
            ul.innerHTML=ul.innerHTML+li
            //console.log(ul)                    
            
        }
        });        

//建立錯誤處理，如果發生錯誤的時候，就往這邊丟，再看要怎麼處理
// .catch(function(err){
// //error

// })
</script>